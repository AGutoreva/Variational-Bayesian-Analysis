<!DOCTYPE html>
<html>

      <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>VBA toolbox</title>
        <meta name="viewport" content="width=device-width">
        <meta name="description" content="Write an awesome description for your new site here. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
        <link rel="canonical" href="/wiki/Miscellaneous-models//" />

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">
        <!-- <link rel="stylesheet" href="/css/pygments_default.css">-->

<!-- icon font -->
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!--<script type="text/javascript" src="/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript" src="/js/jQuery.js"></script>
<script type="text/javascript" src="/js/toc.js"></script>-->
<script type="text/javascript">
$(document).ready(function() {
    $('.toc').toc();
});
</script>

<!--<script type="text/javascript" src="/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->

    </head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">VBA toolbox</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        <a class="page-link" href="/install"><i class="fa fa-download"></i> Install</a>
        <a class="page-link" href="/wiki"><i class="fa fa-book"></i> Wiki</a>
        <a class="page-link" href="/about"><i class="fa fa-mortar-board"></i> About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">
  <header class="post-header">
  <h1 id="title"><a href="/wiki">WIKI</a>&nbsp;Miscellaneous models</h1>
 </header>

  <article class="post-content">
    <hr/>
  <ul id="markdown-toc">
  <li><a href="#statistical-models">Statistical models</a>    <ul>
      <li><a href="#classical-glm-data-analysis">Classical GLM data analysis</a></li>
      <li><a href="#binary-data-classification">Binary data classification</a></li>
      <li><a href="#between-conditions-group-bms">Between-conditions group BMS</a></li>
      <li><a href="#kalman-filtersmoother">Kalman filter/smoother</a></li>
    </ul>
  </li>
  <li><a href="#dynamical-models">Dynamical models</a>    <ul>
      <li><a href="#van-der-pol-oscillator">Van der Pol oscillator</a></li>
      <li><a href="#lorenz-attractor">Lorenz attractor</a></li>
      <li><a href="#double-well-bistable-system">Double-well bistable system</a></li>
      <li><a href="#rossler-attractor">Rossler attractor</a></li>
      <li><a href="#henon-map">Henon map</a></li>
    </ul>
  </li>
</ul>

<p>The toolbox also contains additional models that may not be specific to neurobiological and/or behavioural data. These are typically motivated from generic statistical and/or dynamical considerations, which are briefly described below.</p>

<h1 id="statistical-models">Statistical models</h1>

<h2 id="classical-glm-data-analysis">Classical GLM data analysis</h2>

<p>The general linear model (GLM) is a statistical linear model. The GLM incorporates a number of different statistical models: ANOVA, ANCOVA, MANOVA, MANCOVA, ordinary linear regression, t-test and F-test. It is a generalization of multiple linear regression model to the case of more than one dependent variable. The following script demonstrates VBA’s GLM classical test functionality:</p>

<div><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>X = randn(32,4);
<span class="line-numbers"><a href="#n2" name="n2">2</a></span>b = [1;0;0;0];
<span class="line-numbers"><a href="#n3" name="n3">3</a></span>y = X*b;
<span class="line-numbers"><a href="#n4" name="n4">4</a></span>y = y + randn(size(y));
<span class="line-numbers"><a href="#n5" name="n5">5</a></span>c = [1;0;0;0];
<span class="line-numbers"><a href="#n6" name="n6">6</a></span>[pv] = GLM_contrast(X,y,c,type);
</pre></div>
</div>
</div>
<p>where <code>X</code> is the design matrix, <code>y</code> is the data matrix, <code>c</code> is the contrast matrix, <code>type</code> is flag for the test (t-test or F-test) and <code>pv</code> is the p-value of the corresponding test.</p>

<p>Let us eyeball the graphical output of the function <code>GLM_contrast.m</code>:</p>

<p><img src="/images/wiki/tabs/glm1.jpg" alt="" /></p>

<blockquote>
  <p><strong>Upper-left panel</strong>: observed data (y-axis) plotted against predicted data (x-axis). NB: The percentage of explained variance is indicated (the adjusted R^2 is the percentage of variance explained by the contrast of interest). <strong>Middle-left panel</strong>: observed and predicted data (y-axis) plotted against data dimensions (x-axis). <strong>Lower-left panel</strong>: parameter’s correlation matrix. <strong>Upper-right panel</strong>: parameter estimates plus or minus one standard deviation. NB: Right-clicking on barplots allows one to access the results individual significance F-tests. <strong>Middle-right panel</strong>: contrast of interest. <strong>Lower-right panel</strong>: design matrix. Note that all descriptive statistics can be retrieved from optional output arguments.</p>
</blockquote>

<h2 id="binary-data-classification">Binary data classification</h2>

<p>Strictly speaking, VBa’s default generative model copes with continuous data, for which there is a natural distance metric. Now if the data is categorical, there is no such natural metric, and one has to resort to probability distributions dealing with discrete events. For example, binary data can be treated as binomial (Bernouilli) samples, whose sufficient statistic (first-order moment) is given by the observation function. An interesting application is binary data classification. In the linear case, the observation mapping reduces to a linear mixture of explanatory variables (i.e. features) passed through a sigmoid mapping. In this case, VBA’s objective is to estimate feature weights that generalize over trials. The script <code>demo_bin.m</code> exemplifies such procedure, and demonstrates the relation between classical cross-validation approaches and Bayesian model comparison. See also the demonstration script <code>demo_logistic.m</code>.</p>

<h2 id="between-conditions-group-bms">Between-conditions group BMS</h2>

<p>Until recently, condition and group effects have been addressed by performing random effects BMS independently for the different conditions, and then checking anecdotally to see whether the results of random effects BMS were consistent. This approach is limited, because it does not test the hypothesis that the same model describes the two conditions. VBA provides the inference machinery to evaluate the evidence for a difference – in terms of models – between conditions. This is exemplified in the demosntration script <code>demo_groupbtw.m</code>. Note that the main call function for such analysis writes as follows:</p>

<div><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>[ep,out] = VBA-groupBMCbtw(L)
</pre></div>
</div>
</div>
<p>where <code>L</code> is the log-evidence ND-array, <code>ep</code> is the appropriate exceedance probability, and <code>out</code> gathers diagnostic metrics.</p>

<p>Readers interested in standard group-BMS are encouraged to run the script <code>demo_bmc4glm.m</code>, which relies demonstrates random-effect group BMS in the context of nested models. NB: the model evidence is evaluated at the frequentist limit, using a dedicated function, as follows:</p>

<div><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"><a href="#n1" name="n1">1</a></span>[lev] = lev_GLM(y,X)
</pre></div>
</div>
</div>
<p>where <code>y</code> is the data vector, <code>X</code> is the design matrix, and <code>lev</code> is the log-model evidence evaluated at the frequentist limit (flat priors).</p>

<h2 id="kalman-filtersmoother">Kalman filter/smoother</h2>

<p>The script <code>demo_KalmanSmoother.m</code> demonstrates the smoothing properties of the Kalman lagged filter.<br />
Here, hidden states follow a triangular wave, whose observation is perturbed with white noise. Critically, we render the inversion scheme blind during half a period of the oscillation. We then invert the model (under AR priors on hidden states), with and without large backward lag.</p>

<h1 id="dynamical-models">Dynamical models</h1>

<p>The VBA toolbox includes models that serve as benchmarks for model inversion. Some of these are listed below:</p>

<h2 id="van-der-pol-oscillator">Van der Pol oscillator</h2>

<p>This model captures the essence of action potential dynamics, which essentially consist in stereotypical responses to perturbations, i.e. a stable limit cycle. See <code>demo_VanDerPol.m</code>.</p>

<p><img src="/images/wiki/tabs/VdP1.jpg" alt="" /></p>

<h2 id="lorenz-attractor">Lorenz attractor</h2>

<p>The Lorenz attractor was originally proposed as a simplified version of the Navier-Stokes equations, in the context of meteorological fluid dynamics. The Lorenz attractor models the autonomous formation of convection cells, whose dynamics are parameterized using three parameters: the Rayleigh number (which characterizes the fluid viscosity),  the Prandtl number (which measures the efficacy of heat transport through the boundary layer) and a dissipative coefficient. When the Rayleigh number is bigger than one, the system has two symmetrical fixed points , which act as a pair of local attractors. For certain parameter values, the Lorenz attractor exhibits chaotic behaviour on a butterfly shaped “strange attractor”. For almost any initial conditions (other than the fixed points), the trajectory unfolds on the attractor. The path begins spiralling onto one wing and then jumps to the other and back in a chaotic way. See <code>demo_Lorenz.m</code>.</p>

<p><img src="/images/wiki/tabs/lorenz1.jpg" alt="" /></p>

<h2 id="double-well-bistable-system">Double-well bistable system</h2>

<p>The double-well potential system models a dissipative system, whose potential energy is a quadratic (double-well) function of position. As a consequence, the system is bistable with two basins of attraction to two stable fixed points. In its deterministic variant, the system ends up spiralling around one or the other attractors, depending on its initial conditions and the magnitude of a damping force or dissipative term. Because we consider state-noise, the stochastic DCM can switch (tunnel) from one basin to the other, which leads to itinerant behaviour; this is why the double-well system can be used to model bistable perception. See <code>demo_doubleWell.m</code>.</p>

<p><img src="/images/wiki/tabs/dbw1.jpg" alt="" /></p>

<h2 id="rossler-attractor">Rossler attractor</h2>

<p>This is a model of a continuous-time dynamical system that exhibits chaotic dynamics associated with the fractal properties of the attractor. See <code>demo_Rossler.m</code>.</p>

<p><img src="/images/wiki/tabs/rossler1.jpg" alt="" /></p>

<h2 id="henon-map">Henon map</h2>

<p>This is one of the simplest discrete-time dynamical systems that exhibit chaotic behavior. See <code>demo_Henon.m</code>.</p>

<p><img src="/images/wiki/tabs/henon1.jpg" alt="" /></p>

 <hr/>
  <div class='return_link'><a href="#title"><i class="fa fa-chevron-up"></i> back to top</a></div>
  </article>


</div>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">


    <div class="footer-col-1 column">
        <h2 class="footer-heading">Participate to the VBA-toolbox!</h2>

          <ul>
        <li>
           <i class="fa fa-github-square fa-fw "></i>
          <a href="https://github.com/MBB-team/VBA-toolbox/fork">fork on Github</a>
        </li>
        <li>
          <i class="fa fa-edit fa-fw "></i>
          <a href="https://github.com/MBB-team/VBA-toolbox/issues">post a request</a>
        </li>
        </ul>

    </div>

    <div class="footer-col-2 column">
     <ul>
        <li>Jean DAUNIZEAU</li>
        <li><a href="mailto:jean.daunizeau@gmail.com">jean.daunizeau[at]gmail.com</a></li>
      </ul>
      <ul>
        <li>Lionel RIGOUX</li>
        <li><a href="mailto:lionel.rigoux@gmail.com">lionel.rigoux[at]gmail.com</a></li>
      </ul>

     </div>

    <div class="footer-col-3 column">
<p>J. Daunizeau, V. Adam, L. Rigoux (2014), VBA: a probabilistic treatment of nonlinear models for neurobiological and behavioural data. PLoS Comp Biol 10(1): e1003441.</p>
    </div>

  </div>

</footer>


    </body>

</html>
