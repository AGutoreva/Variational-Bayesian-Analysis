<!DOCTYPE html>
<html>

      <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>VBA toolbox</title>
        <meta name="viewport" content="width=device-width">
        <meta name="description" content="Write an awesome description for your new site here. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
        <link rel="canonical" href="/wiki/VBA-graphical-output//" />

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">
        <!-- <link rel="stylesheet" href="/css/pygments_default.css">-->

<!-- icon font -->
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!--<script type="text/javascript" src="/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript" src="/js/jQuery.js"></script>
<script type="text/javascript" src="/js/toc.js"></script>-->
<script type="text/javascript">
$(document).ready(function() {
    $('.toc').toc();
});
</script>

<!--<script type="text/javascript" src="/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->

    </head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">VBA toolbox</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        <a class="page-link" href="/install"><i class="fa fa-download"></i> Install</a>
        <a class="page-link" href="/wiki"><i class="fa fa-book"></i> Wiki</a>
        <a class="page-link" href="/about"><i class="fa fa-mortar-board"></i> About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">
  <header class="post-header">
  <h1 id="title"><a href="/wiki">WIKI</a>&nbsp;VBA graphical output</h1>
 </header>

  <article class="post-content">
    <hr/>
  <ul id="markdown-toc">
  <li><a href="#summary">Summary</a></li>
  <li><a href="#vb-inversion">VB inversion</a></li>
  <li><a href="#diagnostics">Diagnostics</a></li>
  <li><a href="#kernels">Kernels</a></li>
  <li><a href="#conv">Conv</a></li>
  <li><a href="#priors">Priors</a></li>
</ul>

<p>This page describes the graphical output of the VBA model inversion.<br />
In particular, we focus on the example of a <a href="/wiki/Structure-of-VBA's-generative-model">Q-learning model</a> given observed choices (see <code>demo_Qlearning.m</code> or <a href="/wiki/Fast-demo-Q-learning-model">this page</a>).</p>

<p>By default, the VBA model inversion terminates by displaying the results in a MATLAB window using tabs, which are described below:</p>

<h1 id="summary">Summary</h1>

<p>This tab displays general information about the model inversion, including the log-model evidence for Bayesian model comparison.</p>

<blockquote>
  <p><strong>TIP:</strong> the “null” log-evidence is given here as well, along with fit accuracy metrics (percentage of variance explained, log-likelihood, etc…)</p>
</blockquote>

<p><img src="/images/wiki/tabs/tab1.jpg" alt="" /></p>

<h1 id="vb-inversion">VB inversion</h1>

<p>Sufficient statistics of the posterior densities are displayed here (errorbars depict posterior standard deviations, grey barplots show the difference between the posterior and the prior means). These include the posterior predictive densities (which are plotted against time and against data).</p>

<blockquote>
  <p><strong>TIP:</strong> For binary data (as is the case here), the upper-right panel shows the mean and standard deviation of data samples (y-axis) corresponding to six percentiles of the predicted data (x-axis). Ideally, errorbars should align with the red ellipse (along the main diagonal).</p>
</blockquote>

<p><img src="/images/wiki/tabs/tab2.jpg" alt="" /></p>

<h1 id="diagnostics">Diagnostics</h1>

<p>Diagnostics include estimated state- and measurement noise time-series, histograms and autocorrelation, as well as the parameters’ posterior correlation matrix, etc…</p>

<blockquote>
  <p><strong>TIP:</strong> a high posterior correlation between model two model parameters means that they are non-identifiable (they have the same impact on the data). In our example, only the difference between the initial conditions is identifiable (increasing any of these initial conditions has the same effect on data, hence the positive posterior correlation).</p>
</blockquote>

<p><img src="/images/wiki/tabs/tab3.jpg" alt="" /></p>

<h1 id="kernels">Kernels</h1>

<p>This tab shows the Volterra decomposition of data and system’s states onto the set of the system’s input. Would the system be linear, Volterra kernels would be the impulse response function of the system.</p>

<blockquote>
  <p><strong>TIP:</strong> Volterra weights (y-axis) are plotted against time lag (x-axis) for each input. Positive weights mean that the system’s output increases with the corresponding (lagged) input.</p>
</blockquote>

<p><img src="/images/wiki/tabs/tab4.jpg" alt="" /></p>

<h1 id="conv">Conv</h1>

<p>This is useful for checking the convergence of the VB algorithm. One can eyeball the history of free energy optimization over iterations of the VB algorithm.</p>

<blockquote>
  <p><strong>TIP:</strong> The “null” log-evidence (+/-3) is also shown, for comparison purposes. This provides a dummy Bayesian p-value test for the model (against chance).</p>
</blockquote>

<p><img src="/images/wiki/tabs/tab5.jpg" alt="" /></p>

<h1 id="priors">Priors</h1>

<p>This tab creates a similar display than ‘VB inversion’, but with the sufficient statistics of the prior density (including the prior predictive density, which is also plotted against the data).</p>

<blockquote>
  <p><strong>TIP:</strong> this is useful to get an idea of how much was learned during the model inversion (cf. comparison of prior and posterior predictive densities).</p>
</blockquote>

<p><img src="/images/wiki/tabs/tab6.jpg" alt="" /></p>

 <hr/>
  <div class='return_link'><a href="#title"><i class="fa fa-chevron-up"></i> back to top</a></div>
  </article>


</div>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">


    <div class="footer-col-1 column">
        <h2 class="footer-heading">Participate to the VBA-toolbox!</h2>

          <ul>
        <li>
           <i class="fa fa-github-square fa-fw "></i>
          <a href="https://github.com/MBB-team/VBA-toolbox/fork">fork on Github</a>
        </li>
        <li>
          <i class="fa fa-edit fa-fw "></i>
          <a href="https://github.com/MBB-team/VBA-toolbox/issues">post a request</a>
        </li>
        </ul>

    </div>

    <div class="footer-col-2 column">
     <ul>
        <li>Jean DAUNIZEAU</li>
        <li><a href="mailto:jean.daunizeau@gmail.com">jean.daunizeau[at]gmail.com</a></li>
      </ul>
      <ul>
        <li>Lionel RIGOUX</li>
        <li><a href="mailto:lionel.rigoux@gmail.com">lionel.rigoux[at]gmail.com</a></li>
      </ul>

     </div>

    <div class="footer-col-3 column">
<p>J. Daunizeau, V. Adam, L. Rigoux (2014), VBA: a probabilistic treatment of nonlinear models for neurobiological and behavioural data. PLoS Comp Biol 10(1): e1003441.</p>
    </div>

  </div>

</footer>


    </body>

</html>
