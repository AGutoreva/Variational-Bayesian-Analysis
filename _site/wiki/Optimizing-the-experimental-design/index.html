<!DOCTYPE html>
<html>

      <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>VBA toolbox</title>
        <meta name="viewport" content="width=device-width">
        <meta name="description" content="Write an awesome description for your new site here. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
        <link rel="canonical" href="/wiki/Optimizing-the-experimental-design//" />

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">
        <!-- <link rel="stylesheet" href="/css/pygments_default.css">-->

<!-- icon font -->
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<!--<script type="text/javascript" src="/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript" src="/js/jQuery.js"></script>
<script type="text/javascript" src="/js/toc.js"></script>-->
<script type="text/javascript">
$(document).ready(function() {
    $('.toc').toc();
});
</script>

<!--<script type="text/javascript" src="/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>-->

    </head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">VBA toolbox</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        <a class="page-link" href="/install"><i class="fa fa-download"></i> Install</a>
        <a class="page-link" href="/wiki"><i class="fa fa-book"></i> Wiki</a>
        <a class="page-link" href="/about"><i class="fa fa-mortar-board"></i> About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">
  <header class="post-header">
  <h1 id="title"><a href="/wiki">WIKI</a>&nbsp;Optimizing the experimental design</h1>
 </header>

  <article class="post-content">
    <hr/>
  <ul id="markdown-toc">
  <li><a href="#design-optimality-scores">Design optimality scores</a>    <ul>
      <li><a href="#parameter-estimation">Parameter estimation</a></li>
      <li><a href="#model-selection">Model selection</a></li>
      <li><a href="#on-line-adaptive-designs">On-line adaptive designs</a></li>
    </ul>
  </li>
</ul>

<p>This section describes how to optimize the experimental design with the aim of either estimating model parameters or comparing models of neurobiological/behavioural data. First, we recall the definition of design optimality scores. Then, we suggest on-line extensions to the approach for adapative design strategies.</p>

<h1 id="design-optimality-scores">Design optimality scores</h1>

<p>Optimizing the design in the context of, e.g., experimental psychology studies, amounts to identifying the subset of conditions and stimuli (<code>u</code>) that yields the highest statistical power, under a variety of practical constraints. This requires being able to predict experimental data under models’ assumptions, including potential confounds that may mask the effects of interest. Design optimization can become a difficult issue whenever the impact of experimental factors onto measurements (through the model) is non-trivial and/or uncertain (cf. unknown model parameters). This motivates the use of automatic design optimization.</p>

<p>The VBA toolbox can handle two classes of problems, namely optimizing the system’s input <code>u</code> with respect to either parameter estimation or model selection. These two problems correspond to two different objectives, which can be formalized in terms of statistical loss functions:</p>

<h2 id="parameter-estimation">Parameter estimation</h2>

<p>In this case, one usually minimizes the trace of the expected posterior matrix (cf. so-called “A-optimality”), as follows:</p>

<pre><code class="language-matlab">e = VBA_designEfficiency(f_fname,g_fname,dim,options,u,'parameters');
</code></pre>
<p>where <code>u</code> is the time series of experimental control variables (inputs) that defines the design and <code>e</code> is minus the trace of the expected posterior covariance matrix.</p>

<h2 id="model-selection">Model selection</h2>

<p>In this context, we argue that one should choose among experimental designs according to their induced model selection error rate. This can be done by choosing the input <code>u</code> that minimizes the so-called “Laplace-Chernoff risk”  (cf. Daunizeau et al. 2011), which is an analytical approximation to the model selection error rate:</p>

<script type="math/tex; mode=display">b_{LC}(u) = 1-\frac{1}{2}\log\:\left(\frac{\Delta g(u)^2}{4\tilde Q(u)}+1\right) \quad \text{if}\; \tilde Q_1(u) \approx \tilde Q_2(u) \equiv \tilde Q_(u) </script>

<p><img src="/images/wiki/optim/optim0.jpg" alt="" /></p>

<p>Here, prior predictive densities (y-axis) of two different models are plotted over possible data values (x-axis; unidimensional data). The expected model selection error rate <code>p(e=1|u)</code> increases with the similarity of the two probabilistic model predictions. In fact, the Laplace-Chernoff risk <code>b_LC</code> measures the statistical similarity of the prior predictive densities, as a function of their two first-order moments.</p>

<p>The numerical derivation of the design efficiency for model comparison can be done as follows:</p>

<pre><code class="language-matlab">[e,out] = VBA_designEfficiency(f_fname,g_fname,dim,options,u,'models')
</code></pre>
<p>where <code>f_fname</code>, <code>g_fname</code>, <code>dim</code>, <code>options</code> are nx1 cell arrays (n models), <code>e</code> is minus the Chernoff risk and <code>out</code> is a structure containing diagnostic variables (e.g.: upper bound on selection error probability, 1st and 2nd order-moment of the Laplace approximation to the prior predictive density..).</p>

<p>One can then either compare different designs on the basis of their efficiency (e.g. on a predefined set), or perform numerical optimization of the design efficiency w.r.t. <code>u</code> (or some parametric form of it).</p>

<h2 id="on-line-adaptive-designs">On-line adaptive designs</h2>

<p>In the context of experimental psychophysics, adaptive designs such as “stair-case” methods are used to, e.g., estimate some individual sensory detection or discrimination threshold. Such procedures operate in real-time in the sense that the next stimulation depends on the previous behavioral response and is computed in order to optimize model fitting. More generally, adaptive (on-line) designs can be used to improve on three problems: (i) model parameter estimation; (ii) hypothesis testing (or BMS); (iii) choosing the duration of the experiment (e.g., the number of trials).</p>

<p>We have implemented an example of on-line adaptive design in the demonstration script <code>demo_binomial_AdaptDesign.m</code>. This demo simulates a psychophysics paradigm similar to a signal detection task, whereby the detection probability is a sigmoidal function of the stimulus contrast (which is the design control variable). THe gol of the experiment is to estimate the sigmoid inflexion point (detection threshold) and the sigmoid slope (d prime). Here, the design is adapted online, in the aim of providing the most efficient estimate of these model parameters, given trial-by-trial subjects’ binary choice data (<code>y=1</code>: “seen”, <code>y=0</code>: “unseen”).</p>

<p><img src="/images/wiki/optim/optim1.jpg" alt="" /></p>

<p>On the upper-left graph, one can see the evolution (over trials) the posterior credible intervals over the model parameters (y-axis; blue: sigmoid slope, green: inflexion point) as a function trials (x-axis). These converge very quickly (and precisely) around the simulated values. The upper-right graph shows the estimated response curve, in terms of the detection probability (y-axis) as a function of stimulus contrast (x-axis). The lower-left graph plots the design efficiency (y-axis) as a function of stimulus contrast (x-axis), at the last trial. One can see that the design is most efficient when the sigmoid function is sampled around the maximal curvature regions. The lower-right graph depicts the histogram of design control variables over trials, which has essentially focused the sigmoid sampling around the inflexion point.</p>

<p>Note that the experiment could have been stopped much before (after about 20 trials), on the basis of the convergence of the design efficiency score:</p>

<p><img src="/images/wiki/optim/optim2.jpg" alt="" /></p>

 <hr/>
  <div class='return_link'><a href="#title"><i class="fa fa-chevron-up"></i> back to top</a></div>
  </article>


</div>


      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">


    <div class="footer-col-1 column">
        <h2 class="footer-heading">Participate to the VBA-toolbox!</h2>

          <ul>
        <li>
           <i class="fa fa-github-square fa-fw "></i>
          <a href="https://github.com/MBB-team/VBA-toolbox/fork">fork on Github</a>
        </li>
        <li>
          <i class="fa fa-edit fa-fw "></i>
          <a href="https://github.com/MBB-team/VBA-toolbox/issues">post a request</a>
        </li>
        </ul>

    </div>

    <div class="footer-col-2 column">
     <ul>
        <li>Jean DAUNIZEAU</li>
        <li><a href="mailto:jean.daunizeau@gmail.com">jean.daunizeau[at]gmail.com</a></li>
      </ul>
      <ul>
        <li>Lionel RIGOUX</li>
        <li><a href="mailto:lionel.rigoux@gmail.com">lionel.rigoux[at]gmail.com</a></li>
      </ul>

     </div>

    <div class="footer-col-3 column">
<p>J. Daunizeau, V. Adam, L. Rigoux (2014), VBA: a probabilistic treatment of nonlinear models for neurobiological and behavioural data. PLoS Comp Biol 10(1): e1003441.</p>
    </div>

  </div>

</footer>


    </body>

</html>
